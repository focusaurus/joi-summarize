'use strict'

/**
 * Summarize a set of joi validation errors into a single string.
 *
 * @param {Object} error a joi validation result error.
 *  Typically this was generated by a joi
 *  `validate(input, {abortEarly: false})` method call
 * @param {String} [summary='Invalid input'] The initial error message summary (first line)
 *
 * @return {String} The summarized error message string
 */
function summarize (error, summary) {
  if (error == null) {
    return
  }
  if (typeof error !== 'object') {
    throw new TypeError('error must be a joi error object')
  }
  const paths = (error.details || []).map(detail => detail.message)
  return [summary || 'Invalid input'].concat(paths).join('.\n') + '.\n'
}

module.exports = summarize
